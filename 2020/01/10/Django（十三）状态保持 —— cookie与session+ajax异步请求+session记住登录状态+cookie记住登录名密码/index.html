<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"pasaulis.gitee.io","root":"/blog/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="详情请点阅读全文">
<meta property="og:type" content="article">
<meta property="og:title" content="Django（十三）状态保持 —— cookie与session+ajax异步请求+session记住登录状态+cookie记住登录名密码">
<meta property="og:url" content="https://pasaulis.gitee.io/blog/2020/01/10/Django%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E7%8A%B6%E6%80%81%E4%BF%9D%E6%8C%81%20%E2%80%94%E2%80%94%20cookie%E4%B8%8Esession+ajax%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82+session%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81+cookie%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E5%90%8D%E5%AF%86%E7%A0%81/index.html">
<meta property="og:site_name" content="晨曦的博客">
<meta property="og:description" content="详情请点阅读全文">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109101715840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109113217869.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109113305747.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109113526836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109114133630.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109115917362.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109143544143.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109145357689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109163841263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109163853976.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109164347335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109164420192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109164441551.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109152919743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109152958428.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109154104466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109154203696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109154246621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109155126257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200109155054344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">
<meta property="article:published_time" content="2020-01-10T02:28:30.000Z">
<meta property="article:modified_time" content="2020-03-23T03:01:39.360Z">
<meta property="article:author" content="晨曦">
<meta property="article:tag" content="python">
<meta property="article:tag" content="vue">
<meta property="article:tag" content="react">
<meta property="article:tag" content="AI">
<meta property="article:tag" content="人工智能">
<meta property="article:tag" content="爬虫">
<meta property="article:tag" content="大数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img-blog.csdnimg.cn/20200109101715840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70">

<link rel="canonical" href="https://pasaulis.gitee.io/blog/2020/01/10/Django%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E7%8A%B6%E6%80%81%E4%BF%9D%E6%8C%81%20%E2%80%94%E2%80%94%20cookie%E4%B8%8Esession+ajax%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82+session%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81+cookie%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E5%90%8D%E5%AF%86%E7%A0%81/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Django（十三）状态保持 —— cookie与session+ajax异步请求+session记住登录状态+cookie记住登录名密码 | 晨曦的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/blog/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">晨曦的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">技术博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/blog/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/blog/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/blog/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://pasaulis.gitee.io/blog/2020/01/10/Django%EF%BC%88%E5%8D%81%E4%B8%89%EF%BC%89%E7%8A%B6%E6%80%81%E4%BF%9D%E6%8C%81%20%E2%80%94%E2%80%94%20cookie%E4%B8%8Esession+ajax%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82+session%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81+cookie%E8%AE%B0%E4%BD%8F%E7%99%BB%E5%BD%95%E5%90%8D%E5%AF%86%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="http://www.zeyajt.com/u/40b74ddb-a87b-41cd-821b-3f6eeb544661/image/637203952121373129.jpg">
      <meta itemprop="name" content="晨曦">
      <meta itemprop="description" content="晨曦的技术博客，专注于python、vue、react、人工智能、爬虫、大数据分析">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Django（十三）状态保持 —— cookie与session+ajax异步请求+session记住登录状态+cookie记住登录名密码
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-01-10 10:28:30" itemprop="dateCreated datePublished" datetime="2020-01-10T10:28:30+08:00">2020-01-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-23 11:01:39" itemprop="dateModified" datetime="2020-03-23T11:01:39+08:00">2020-03-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/python/Django/" itemprop="url" rel="index"><span itemprop="name">Django</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>详情请点阅读全文 </p>
<a id="more"></a>

<h1 id="一-状态保持的概述"><a href="#一-状态保持的概述" class="headerlink" title="一.状态保持的概述"></a>一.状态保持的概述</h1><p>http协议是无状态的。下一次去访问一个页面时并不知道上一次对这个页面做了什么。因此引入了cookie、session两种方式来配合解决此问题。<br>Duplicate entry：重复条目</p>
<h1 id="二、Cookie（存储在客户端）"><a href="#二、Cookie（存储在客户端）" class="headerlink" title="二、Cookie（存储在客户端）"></a>二、Cookie（存储在客户端）</h1><ul>
<li>cookie是由服务器生成，存储在浏览器端的一小段文本信息。<br><img src="https://img-blog.csdnimg.cn/20200109101715840.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h2 id="1-1-cookie的特点："><a href="#1-1-cookie的特点：" class="headerlink" title="1.1 cookie的特点："></a>1.1 cookie的特点：</h2>0) 服务器通过HttpRessponse的对象set_cookie设置cookie：<code>HttpRessponse.set_cookie</code><br>1) 浏览器以键值对方式进行存储。<br>2) 通过浏览器访问一个网站时，会将浏览器存储的跟网站相关的所有cookie信息发送给该网站的服务器。（服务器取cookies：<code>request.COOKIES</code>）<br>3) cookie是基于域名安全的。<a href="http://www.baidu.com" target="_blank" rel="noopener">www.baidu.com</a> <a href="http://www.tudou.com" target="_blank" rel="noopener">www.tudou.com</a><br>4) cookie是有过期时间的，如果不指定，默认关闭浏览器之后cookie就会过期。<h2 id="1-2-cookie基础使用案例"><a href="#1-2-cookie基础使用案例" class="headerlink" title="1.2 cookie基础使用案例"></a>1.2 cookie基础使用案例</h2><h3 id="1）app1-views-py编写设置cookie设置-获取函数"><a href="#1）app1-views-py编写设置cookie设置-获取函数" class="headerlink" title="1）app1/views.py编写设置cookie设置/获取函数"></a>1）app1/views.py编写设置cookie设置/获取函数</h3></li>
</ul>
<p>1.设置cookie：/setCookie<br>2.获取cookie：/getCookie</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.设置cookie：/setCookie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_cookie</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''请求设置cookie'''</span></span><br><span class="line">    response=HttpResponse(<span class="string">'设置cookie'</span>) <span class="comment">#【1】</span></span><br><span class="line">    response.set_cookie(<span class="string">'name'</span>,<span class="string">'jim'</span>)<span class="comment">#【2】</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"><span class="comment">#2.获取cookie：/getCookie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_cookie</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''服务器获取浏览器的cookie'''</span></span><br><span class="line">    name=request.COOKIES[<span class="string">'name'</span>]<span class="comment">#【3】注意必须大写</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(name)</span><br></pre></td></tr></table></figure>
<h3 id="2）配置app1-urls-py"><a href="#2）配置app1-urls-py" class="headerlink" title="2）配置app1/urls.py"></a>2）配置app1/urls.py</h3><p>设置cookie页<br>获取cookie页</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,re_path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">re_path(<span class="string">'^setCookie$'</span>,views.set_cookie),<span class="comment">#设置cookie页</span></span><br><span class="line">re_path(<span class="string">'^getCookie$'</span>,views.get_cookie),<span class="comment">#获取cookie页</span></span><br></pre></td></tr></table></figure>
<h3 id="效果："><a href="#效果：" class="headerlink" title="效果："></a>效果：</h3><h4 id="http-127-0-0-1-8000-setCookie"><a href="#http-127-0-0-1-8000-setCookie" class="headerlink" title="http://127.0.0.1:8000/setCookie"></a><a href="http://127.0.0.1:8000/setCookie" target="_blank" rel="noopener">http://127.0.0.1:8000/setCookie</a></h4><p>显示：设置cookie<br><img src="https://img-blog.csdnimg.cn/20200109113217869.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>返回头将看到：set-Cookie:name=jim; path=/<br><img src="https://img-blog.csdnimg.cn/20200109113305747.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="http-127-0-0-1-8000-getCookie"><a href="#http-127-0-0-1-8000-getCookie" class="headerlink" title="http://127.0.0.1:8000/getCookie"></a><a href="http://127.0.0.1:8000/getCookie" target="_blank" rel="noopener">http://127.0.0.1:8000/getCookie</a></h4><p>显示jim，请求头里有个信息即发送给服务器的cookie<code>Cookie:sessionid=5pvq8zmkgtb9omarod4q52lhfsmcc5sp; csrftoken=hW4qfF5faVmg60G1RRf7KCL8ZuwnA0OR7OqYpufJedQOGY3IZKaZmS6EXbLfbk8j; name=jim</code><br><img src="https://img-blog.csdnimg.cn/20200109113526836.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="关闭浏览器之后，再请求cookie即找不到之前设置的cookie-因为没指定时间，所以用默认设置，关闭即过期："><a href="#关闭浏览器之后，再请求cookie即找不到之前设置的cookie-因为没指定时间，所以用默认设置，关闭即过期：" class="headerlink" title="关闭浏览器之后，再请求cookie即找不到之前设置的cookie,因为没指定时间，所以用默认设置，关闭即过期："></a>关闭浏览器之后，再请求cookie即找不到之前设置的cookie,因为没指定时间，所以用默认设置，关闭即过期：</h4><p><a href="http://127.0.0.1:8000/getCookie" target="_blank" rel="noopener">http://127.0.0.1:8000/getCookie</a><br><img src="https://img-blog.csdnimg.cn/20200109114133630.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="3）设置cookie过期时间views-py"><a href="#3）设置cookie过期时间views-py" class="headerlink" title="3）设置cookie过期时间views.py"></a>3）设置cookie过期时间views.py</h3><ol>
<li>设置过期方式一 【max_age】（单位：秒）：<code>max_age=14*24*3600</code> 14天后过期</li>
<li>设置过期方式二 【expires】 （单位：时间）：<code>expires=datetime.now()+timedelta(days=14)</code> 14天后过期<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,redirect</span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse,JsonResponse</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timedelta <span class="comment">#【0】注意引入</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># /set_cookie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_cookie</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''设置cookie信息'''</span></span><br><span class="line">    response = HttpResponse(<span class="string">'设置cookie'</span>)</span><br><span class="line">    <span class="comment"># 设置一个cookie信息,名字为num, 值为1</span></span><br><span class="line">    <span class="comment"># response.set_cookie('num2', 2)</span></span><br><span class="line">    response.set_cookie(<span class="string">'num'</span>, <span class="number">1</span>, max_age=<span class="number">14</span>*<span class="number">24</span>*<span class="number">3600</span>) <span class="comment">#【1】14天后过期，单位，秒</span></span><br><span class="line">    <span class="comment"># response.set_cookie('num', 1, expires=datetime.now()+timedelta(days=14)) #【2】即现在时间为准+14天后过期</span></span><br><span class="line">    <span class="comment"># 返回response</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>
<h4 id="效果：http-127-0-0-1-8000-setCookie"><a href="#效果：http-127-0-0-1-8000-setCookie" class="headerlink" title="效果：http://127.0.0.1:8000/setCookie"></a>效果：<a href="http://127.0.0.1:8000/setCookie" target="_blank" rel="noopener">http://127.0.0.1:8000/setCookie</a></h4>再设置时会看到一个14天的日期<br><img src="https://img-blog.csdnimg.cn/20200109115917362.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>以后14天内这个cookie都会存在 。</li>
</ol>
<h3 id="4-设置多个cookie"><a href="#4-设置多个cookie" class="headerlink" title="4) 设置多个cookie"></a>4) 设置多个cookie</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#1.设置cookie：/setCookie</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_cookie</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''请求设置cookie'''</span></span><br><span class="line">    </span><br><span class="line">    response=HttpResponse(<span class="string">'设置cookie'</span>)</span><br><span class="line">    response.set_cookie(<span class="string">'name'</span>,<span class="string">'jim'</span>,max_age=<span class="number">14</span>*<span class="number">24</span>*<span class="number">3600</span>) <span class="comment">#14天后过期</span></span><br><span class="line">    </span><br><span class="line">    response=HttpResponse(<span class="string">'设置cookie2'</span>)</span><br><span class="line">    response.set_cookie(<span class="string">'age'</span>,<span class="number">20</span>,max_age=<span class="number">15</span>*<span class="number">24</span>*<span class="number">3600</span>) <span class="comment">#14天后过期</span></span><br><span class="line">    <span class="keyword">return</span> response</span><br></pre></td></tr></table></figure>
<h2 id="1-3-记住用户名案例"><a href="#1-3-记住用户名案例" class="headerlink" title="1.3 记住用户名案例"></a><font color='red'>1.3 记住用户名案例</font></h2><h3 id="1）templates-app1-login-html"><a href="#1）templates-app1-login-html" class="headerlink" title="1）templates/app1/login.html"></a>1）templates/app1/login.html</h3><p>【1】添加记住用户名，设置cookie用，如果勾选则其value=on<br>【2】js添加是否记住用户名<br>【3】js添加发送数据，加上remember<br>【4】把views页的login()函数传过来的用户名，密码赋值给对应处<br> 用户名:<code>&lt;input type=&quot;text&quot; id=&quot;username&quot; value=&quot;&quot;&gt;&lt;br/&gt;</code><br>    密码:<code>&lt;input type=&quot;password&quot; id=&quot;password&quot; value=&quot;&quot;&gt;&lt;br/&gt;</code></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;!-- 【0】引入jquery --&gt;</span><br><span class="line">    &lt;script src="/static/js/jquery-1.12.4.min.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;title&gt;登录页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 写ajax处理函数</span><br><span class="line">    $(function () &#123;</span><br><span class="line">        $(<span class="string">'#btnLogin'</span>).click(function () &#123;</span><br><span class="line">            //<span class="number">1.</span>获取用户名、密码、是否记住用户名</span><br><span class="line">            username=$(<span class="string">'#username'</span>).val()</span><br><span class="line">            password=$(<span class="string">'#password'</span>).val()</span><br><span class="line">            remember=$(<span class="string">'#remember'</span>).val() //【<span class="number">2</span>】是否记住用户名</span><br><span class="line">            //<span class="number">2.</span>发起ajax--post(username,password)请求验证，地址：/login_check</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                <span class="string">'url'</span>:<span class="string">'/login_check'</span>,//验证地址</span><br><span class="line">                <span class="string">'type'</span>:<span class="string">'post'</span>,//请求类型</span><br><span class="line">                <span class="string">'data'</span>:&#123;<span class="string">'username'</span>:username,<span class="string">'password'</span>:password,<span class="string">'remember'</span>:remember&#125;,//【<span class="number">3</span>】发送数据，加上remember</span><br><span class="line">                <span class="string">'dataType'</span>:<span class="string">'json'</span>,//希望返回数据类型</span><br><span class="line">            &#125;).success(function(data)&#123;</span><br><span class="line">                //成功返回&#123;<span class="string">'res'</span>:<span class="number">1</span>&#125;,失败&#123;<span class="string">'res'</span>:<span class="number">0</span>&#125;</span><br><span class="line">                <span class="keyword">if</span>(data.res===<span class="number">0</span>)&#123;</span><br><span class="line">                    $(<span class="string">'#msg'</span>).show().html(<span class="string">'用户名或密码错误请重试！'</span>)//登录失败则显示msg，并在里写入信息</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;//成功跳转到books页面</span><br><span class="line">                    location.href=<span class="string">'/books'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    /* 信息提示样式 */</span><br><span class="line"><span class="comment">#msg&#123;</span></span><br><span class="line">    display: none;</span><br><span class="line">    color:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- 原form删除，input的name变id，方便jquery操作 --&gt;</span><br><span class="line">    &lt;!-- 【4】把views页的login()函数传过来的用户名，密码赋值给对应处 --&gt;</span><br><span class="line">    用户名:&lt;input type=<span class="string">"text"</span> id=<span class="string">"username"</span> value=<span class="string">"&#123;&#123;username&#125;&#125;"</span>&gt;&lt;br/&gt;</span><br><span class="line">    密码:&lt;input type=<span class="string">"password"</span> id=<span class="string">"password"</span> value=<span class="string">"&#123;&#123;password&#125;&#125;"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;!-- 加入一个信息提示框，用于密码等错误提示 --&gt;</span><br><span class="line">    &lt;div id="msg"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- 【1】记住用户名，设置cookie用，如果勾选则其value=on --&gt;</span><br><span class="line">    &lt;input type=<span class="string">"checkbox"</span> id=<span class="string">"remember"</span>&gt;记住用户名&lt;br/&gt;</span><br><span class="line">    &lt;!-- 按钮type改button,加一个id方便jquery操作 --&gt;</span><br><span class="line">    &lt;input type=<span class="string">"button"</span> id=<span class="string">"btnLogin"</span> value=<span class="string">"登录"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="2）app1-urls-py-不重要"><a href="#2）app1-urls-py-不重要" class="headerlink" title="2）app1/urls.py(不重要)"></a>2）app1/urls.py(不重要)</h3><p>【1】登录页<br>【2】登录检测</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,re_path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns=[</span><br><span class="line">    path(<span class="string">'login/'</span>,views.login),<span class="comment">#【1】登录页</span></span><br><span class="line">    path(<span class="string">'login_check'</span>,views.login_check),<span class="comment">#【2】登录检测</span></span><br><span class="line"></span><br><span class="line">    re_path(<span class="string">'^setCookie$'</span>,views.set_cookie),<span class="comment">#设置cookie页</span></span><br><span class="line">    re_path(<span class="string">'^getCookie$'</span>,views.get_cookie),<span class="comment">#获取cookie页</span></span><br><span class="line"></span><br><span class="line">    path(<span class="string">'app1/'</span>,views.index),</span><br><span class="line">    path(<span class="string">'books/'</span>,views.books),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 书详情页，通过url接收参数2种写法以下两种都可：</span></span><br><span class="line">    <span class="comment"># path(r"detail/&lt;int:bookId&gt;",views.detail), #参数用尖括号包起来&lt;&gt;</span></span><br><span class="line">    re_path(<span class="string">r"^detail/(\d+)"</span>,views.detail), <span class="comment">#参数必须要带括号</span></span><br><span class="line"></span><br><span class="line">    path(<span class="string">'addInfo/'</span>,views.addInfo), <span class="comment">#添加三国书</span></span><br><span class="line"></span><br><span class="line">    path(<span class="string">r'delete/&lt;int:bid&gt;'</span>,views.deleteInfo), <span class="comment">#删除对应图书</span></span><br><span class="line"></span><br><span class="line">    path(<span class="string">r'areas/'</span>,views.areas), <span class="comment">#展示对应省市区信息</span></span><br><span class="line"></span><br><span class="line">    path(<span class="string">r'test_ajax'</span>,views.test_ajax),<span class="comment">#ajax测试页</span></span><br><span class="line">    path(<span class="string">r'ajax_handle/'</span>,views.ajax_handle),<span class="comment">#ajax测试页</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># re_path(r'^login_ajax', views.login_ajax), # 显示ajax登录页面</span></span><br><span class="line">    <span class="comment"># re_path(r'^login_ajax_check', views.login_ajax_check), # ajax登录校验</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="3）app1-views-py【重点】"><a href="#3）app1-views-py【重点】" class="headerlink" title="3）app1/views.py【重点】"></a>3）app1/views.py【重点】</h3><p>【1】接收remeber<br>【2】正确返回1，重写<br>【3】如果remember==on，则把用户名,密码设置cookie到cookie<br>【4】不要忘记返回response<br>【5】如果用户名密码已经在cookie中，则取到它，并做为参数返回给渲染页面<br>[6]获取cookie中的用户名、密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,redirect <span class="comment">#引入重定向简写模块</span></span><br><span class="line"><span class="keyword">from</span> app1.models <span class="keyword">import</span> BookInfo,AreaInfo <span class="comment">#从模型下导入bookinfo数据模型</span></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse,HttpResponseRedirect,JsonResponse <span class="comment">#引入返回请求模块、重新定向模块</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timedelta <span class="comment"># 引用时间模块</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''登录页'''</span></span><br><span class="line">    <span class="comment">#【5】如果用户名密码已经在cookie中，则取到它，并做为参数返回给渲染页面</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'username'</span> <span class="keyword">in</span> request.COOKIES:</span><br><span class="line">        <span class="comment">#[6]获取cookie中的用户名、密码</span></span><br><span class="line">        username=request.COOKIES[<span class="string">'username'</span>]</span><br><span class="line">        password=request.COOKIES[<span class="string">'password'</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        username=<span class="string">''</span></span><br><span class="line">        password=<span class="string">''</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'app1/login.html'</span>,&#123;<span class="string">'username'</span>:username,<span class="string">'password'</span>:password&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_check</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''登录校验'''</span></span><br><span class="line">    <span class="comment">#1.获取用户名密码</span></span><br><span class="line">    username=request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">    password=request.POST.get(<span class="string">'password'</span>)</span><br><span class="line">    remember=request.POST.get(<span class="string">'remember'</span>) <span class="comment">#【1】接收remeber</span></span><br><span class="line">    <span class="comment">#2.进行校验，并返回json数据</span></span><br><span class="line">    <span class="keyword">if</span> username==<span class="string">'jim'</span> <span class="keyword">and</span> password==<span class="string">'123'</span>:</span><br><span class="line">        <span class="comment">#return redirect('/books')</span></span><br><span class="line">        response = JsonResponse(&#123;<span class="string">'res'</span>:<span class="number">1</span>&#125;) <span class="comment">#【2】正确返回1，重写</span></span><br><span class="line">        <span class="comment">#【3】如果remember==on，则把用户名,密码设置cookie到cookie</span></span><br><span class="line">        <span class="keyword">if</span> remember==<span class="string">'on'</span>:</span><br><span class="line">            response.set_cookie(<span class="string">'username'</span>,username,max_age=<span class="number">7</span>*<span class="number">24</span>*<span class="number">3600</span>)</span><br><span class="line">            response.set_cookie(<span class="string">'password'</span>,password,max_age=<span class="number">7</span>*<span class="number">24</span>*<span class="number">3600</span>)</span><br><span class="line">        <span class="keyword">return</span> response <span class="comment">#【4】不要忘记返回response</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#return redirect('/login')</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'res'</span>:<span class="number">0</span>&#125;) <span class="comment">#错误返回0</span></span><br></pre></td></tr></table></figure>
<h3 id="效果-http-127-0-0-1-8000-login"><a href="#效果-http-127-0-0-1-8000-login" class="headerlink" title="效果 http://127.0.0.1:8000/login/"></a>效果 <a href="http://127.0.0.1:8000/login/" target="_blank" rel="noopener">http://127.0.0.1:8000/login/</a></h3><p>如果勾选上记住用户名，提交时会让/login_check处理，把用户名、密码的cookie设置到浏览器，<br>再次来到login页面时，用户名密码会通过templates/login页里的变量直接赋值到对应处，从而实现免填密码登录。<br><img src="https://img-blog.csdnimg.cn/20200109143544143.png" alt="在这里插入图片描述"></p>
<h1 id="三、Session（存储在服务器端）"><a href="#三、Session（存储在服务器端）" class="headerlink" title="三、Session（存储在服务器端）"></a>三、Session（存储在服务器端）</h1><p>session存储在服务器端。<br><img src="https://img-blog.csdnimg.cn/20200109145357689.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="1-配置"><a href="#1-配置" class="headerlink" title="1 配置"></a>1 配置</h2><h3 id="启用Session"><a href="#启用Session" class="headerlink" title="启用Session"></a>启用Session</h3><p>Django项目默认启用Session。<br>打开test3/settings.py文件，在项MIDDLEWARE_CLASSES中启用Session中间件。<br>session中间件<br><img src="https://img-blog.csdnimg.cn/20200109163841263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>禁用Session：将Session中间件删除。<br><img src="https://img-blog.csdnimg.cn/20200109163853976.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="存储方式"><a href="#存储方式" class="headerlink" title="存储方式"></a>存储方式</h3><p>打开test3/settings.py文件，设置SESSION_ENGINE项指定Session数据存储的方式，可以存储在数据库、缓存、Redis等。</p>
<p>1）存储在数据库中，如下设置可以写，也可以不写，这是默认存储方式。</p>
<p>SESSION_ENGINE=’django.contrib.sessions.backends.db’<br>2）存储在缓存中：存储在本机内存中，如果丢失则不能找回，比数据库的方式读写更快。</p>
<p>SESSION_ENGINE=’django.contrib.sessions.backends.cache’<br>3）混合存储：优先从本机内存中存取，如果没有则从数据库中存取。</p>
<p>SESSION_ENGINE=’django.contrib.sessions.backends.cached_db’<br>4）如果存储在数据库中，需要在项INSTALLED_APPS中安装Session应用。<br><img src="https://img-blog.csdnimg.cn/20200109164347335.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>5）迁移后会在数据库中创建出存储Session的表。<br><img src="https://img-blog.csdnimg.cn/20200109164420192.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>存储session</p>
<p>6）表结构如下图。<br><img src="https://img-blog.csdnimg.cn/20200109164441551.png" alt="在这里插入图片描述"><br>存储session表结构<br>由表结构可知，操作Session包括三个数据：键，值，过期时间。</p>
<h2 id="2-使用方法："><a href="#2-使用方法：" class="headerlink" title="2 使用方法："></a>2 使用方法：</h2><h3 id="1-设置：session-request-session-39-username-39-39-jim-39"><a href="#1-设置：session-request-session-39-username-39-39-jim-39" class="headerlink" title="1.设置：session:request.session[&#39;username&#39;]=&#39;jim&#39;"></a>1.设置：<code>session:request.session[&#39;username&#39;]=&#39;jim&#39;</code></h3><h3 id="2-获取：session-request-session-39-username-39"><a href="#2-获取：session-request-session-39-username-39" class="headerlink" title="2.获取：session:request.session[&#39;username&#39;]"></a>2.获取：<code>session:request.session[&#39;username&#39;]</code></h3><h3 id="3-清除所有session，在存储中删除值部分。"><a href="#3-清除所有session，在存储中删除值部分。" class="headerlink" title="3.清除所有session，在存储中删除值部分。"></a>3.清除所有session，在存储中删除值部分。</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.session.clear()</span><br></pre></td></tr></table></figure>
<h3 id="4-清除session数据，在存储中删除session的整条数据。"><a href="#4-清除session数据，在存储中删除session的整条数据。" class="headerlink" title="4. 清除session数据，在存储中删除session的整条数据。"></a>4. 清除session数据，在存储中删除session的整条数据。</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">request.session.flush()</span><br></pre></td></tr></table></figure>
<h3 id="5-删除session中的指定键及值，在存储中只删除某个键及对应的值。"><a href="#5-删除session中的指定键及值，在存储中只删除某个键及对应的值。" class="headerlink" title="5. 删除session中的指定键及值，在存储中只删除某个键及对应的值。"></a>5. 删除session中的指定键及值，在存储中只删除某个键及对应的值。</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> request.session[<span class="string">'键'</span>]</span><br></pre></td></tr></table></figure>
<h3 id="6-设置会话的超时时间，如果没有指定过期时间则两个星期后过期。"><a href="#6-设置会话的超时时间，如果没有指定过期时间则两个星期后过期。" class="headerlink" title="6.设置会话的超时时间，如果没有指定过期时间则两个星期后过期。"></a>6.设置会话的超时时间，如果没有指定过期时间则两个星期后过期。</h3><p><strong>request.session.set_expiry(value)</strong></p>
<ul>
<li>如果value是一个整数，会话将在value秒没有活动后过期。</li>
<li>如果value为0，那么用户会话的Cookie将在用户的浏览器关闭时过期。</li>
<li>如果value为None，那么会话永不过期。</li>
</ul>
<h2 id="3-1-session的特点："><a href="#3-1-session的特点：" class="headerlink" title="3.1 session的特点："></a>3.1 session的特点：</h2><p>1) session是以键值对进行存储的。<br>2) session依赖于cookie。唯一的标识码保存在sessionid cookie中。<br>3) session也是有过期时间，如果不指定，默认两周就会过期。<br>4. 保存的是字符串，得到就是字符串，是数字，得到即数字。<br>5. session保存位置：对应数据库的表 django_session<br>6. <img src="https://img-blog.csdnimg.cn/20200109152919743.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>7. <img src="https://img-blog.csdnimg.cn/20200109152958428.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="3-2-session基本设置、获取、清除案例"><a href="#3-2-session基本设置、获取、清除案例" class="headerlink" title="3.2 session基本设置、获取、清除案例"></a>3.2 session基本设置、获取、清除案例</h2><h3 id="1）app1-views-py"><a href="#1）app1-views-py" class="headerlink" title="1）app1/views.py"></a>1）app1/views.py</h3><p>设置session过期时间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#test /set_session</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_session</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''设置session'''</span></span><br><span class="line">    request.session[<span class="string">'username'</span>] = <span class="string">'smart'</span></span><br><span class="line">    request.session[<span class="string">'age'</span>] = <span class="number">18</span></span><br><span class="line">    <span class="comment"># request.session.set_expiry(5) #设置session过期时间</span></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">'设置session'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#test /get_session</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_session</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''获取session'''</span></span><br><span class="line">    username = request.session[<span class="string">'username'</span>]</span><br><span class="line">    age = request.session[<span class="string">'age'</span>]</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(username+<span class="string">':'</span>+str(age))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#test　/clear_session</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clear_session</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''清除session信息'''</span></span><br><span class="line">    <span class="comment"># request.session.clear()</span></span><br><span class="line">    request.session.flush()</span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">'清除成功'</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2）app1-urls-py"><a href="#2）app1-urls-py" class="headerlink" title="2）app1/urls.py"></a>2）app1/urls.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">re_path(<span class="string">'^setSession$'</span>,views.set_session),<span class="comment">#设置session页</span></span><br><span class="line">   re_path(<span class="string">'^getSession$'</span>,views.get_session),<span class="comment">#获取session页</span></span><br><span class="line">   re_path(<span class="string">'^clearSession$'</span>,views.clear_session),<span class="comment">#获取session页</span></span><br></pre></td></tr></table></figure>

<h3 id="效果-http-127-0-0-1-8000-setSession"><a href="#效果-http-127-0-0-1-8000-setSession" class="headerlink" title="效果 http://127.0.0.1:8000/setSession"></a>效果 <a href="http://127.0.0.1:8000/setSession" target="_blank" rel="noopener">http://127.0.0.1:8000/setSession</a></h3><p><img src="https://img-blog.csdnimg.cn/20200109154104466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="http-127-0-0-1-8000-getSession"><a href="#http-127-0-0-1-8000-getSession" class="headerlink" title="http://127.0.0.1:8000/getSession"></a><a href="http://127.0.0.1:8000/getSession" target="_blank" rel="noopener">http://127.0.0.1:8000/getSession</a></h3><p><img src="https://img-blog.csdnimg.cn/20200109154203696.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="http-127-0-0-1-8000-clearSession"><a href="#http-127-0-0-1-8000-clearSession" class="headerlink" title="http://127.0.0.1:8000/clearSession"></a><a href="http://127.0.0.1:8000/clearSession" target="_blank" rel="noopener">http://127.0.0.1:8000/clearSession</a></h3><p><img src="https://img-blog.csdnimg.cn/20200109154246621.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h3 id="扩展：session的数据库保存值是base64编码"><a href="#扩展：session的数据库保存值是base64编码" class="headerlink" title="扩展：session的数据库保存值是base64编码"></a>扩展：session的数据库保存值是base64编码</h3><p>可在百度搜索 【base64解码】，查看其保存具体信息<br><img src="https://img-blog.csdnimg.cn/20200109155126257.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><a href="https://base64.supfree.net/" target="_blank" rel="noopener">https://base64.supfree.net/</a><br><img src="https://img-blog.csdnimg.cn/20200109155054344.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3UwMTAxMzIxNzc=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="3-3-记住用户登录状态案例"><a href="#3-3-记住用户登录状态案例" class="headerlink" title="3.3 记住用户登录状态案例"></a><font color='red'>3.3 记住用户登录状态案例</font></h2><h3 id="1）app1-views-py编写登录函数-设置session-读取session"><a href="#1）app1-views-py编写登录函数-设置session-读取session" class="headerlink" title="1）app1/views.py编写登录函数:设置session,读取session"></a>1）app1/views.py编写登录函数:设置session,读取session</h3><p>【1】如果用户勾选了remember的条件下，设置session,记住用户登录状态<br>【2】判断用户是否登录，用户已登录, 直接跳转到图书列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,redirect <span class="comment">#引入重定向简写模块</span></span><br><span class="line"><span class="keyword">from</span> app1.models <span class="keyword">import</span> BookInfo,AreaInfo <span class="comment">#从模型下导入bookinfo数据模型</span></span><br><span class="line"><span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse,HttpResponseRedirect,JsonResponse <span class="comment">#引入返回请求模块、重新定向模块</span></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime,timedelta <span class="comment"># 引用时间模块</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''登录页'''</span></span><br><span class="line">    <span class="comment"># 【2】判断用户是否登录，用户已登录, 直接跳转到图书列表</span></span><br><span class="line">    <span class="keyword">if</span> request.session.has_key(<span class="string">'islogin'</span>):</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">'/books'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#如果用户名密码已经在cookie中，则取到它，并做为参数返回给渲染页面</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">'username'</span> <span class="keyword">in</span> request.COOKIES:</span><br><span class="line">            <span class="comment">#获取cookie中的用户名、密码</span></span><br><span class="line">            username=request.COOKIES[<span class="string">'username'</span>]</span><br><span class="line">            password=request.COOKIES[<span class="string">'password'</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            username=<span class="string">''</span></span><br><span class="line">            password=<span class="string">''</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">'app1/login.html'</span>,&#123;<span class="string">'username'</span>:username,<span class="string">'password'</span>:password&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login_check</span><span class="params">(request)</span>:</span></span><br><span class="line">    <span class="string">'''登录校验'''</span></span><br><span class="line">    <span class="comment">#1.获取用户名密码</span></span><br><span class="line">    username=request.POST.get(<span class="string">'username'</span>)</span><br><span class="line">    password=request.POST.get(<span class="string">'password'</span>)</span><br><span class="line">    remember=request.POST.get(<span class="string">'remember'</span>) <span class="comment">#接收remeber</span></span><br><span class="line">    <span class="comment">#2.进行校验，并返回json数据</span></span><br><span class="line">    <span class="keyword">if</span> username==<span class="string">'jim'</span> <span class="keyword">and</span> password==<span class="string">'123'</span>:</span><br><span class="line">        <span class="comment">#return redirect('/books')</span></span><br><span class="line">        response = JsonResponse(&#123;<span class="string">'res'</span>:<span class="number">1</span>&#125;) <span class="comment">#正确返回1，重写</span></span><br><span class="line">        <span class="comment">#如果remember==on，则把用户名,密码设置cookie到cookie</span></span><br><span class="line">        <span class="keyword">if</span> remember==<span class="string">'on'</span>:</span><br><span class="line">            response.set_cookie(<span class="string">'username'</span>,username,max_age=<span class="number">7</span>*<span class="number">24</span>*<span class="number">3600</span>)</span><br><span class="line">            response.set_cookie(<span class="string">'password'</span>,password,max_age=<span class="number">7</span>*<span class="number">24</span>*<span class="number">3600</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 【1】如果用户勾选了remember的条件下，设置session,记住用户登录状态</span></span><br><span class="line">        request.session[<span class="string">'islogin'</span>] = <span class="literal">True</span> <span class="comment"># 只有session中有islogin,就认为用户已登录</span></span><br><span class="line">        <span class="keyword">return</span> response <span class="comment">#不要忘记返回response</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment">#return redirect('/login')</span></span><br><span class="line">        <span class="keyword">return</span> JsonResponse(&#123;<span class="string">'res'</span>:<span class="number">0</span>&#125;) <span class="comment">#错误返回0</span></span><br></pre></td></tr></table></figure>
<h3 id="2）app1-urls-py-1"><a href="#2）app1-urls-py-1" class="headerlink" title="2）app1/urls.py"></a>2）app1/urls.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path,re_path</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> views</span><br><span class="line"></span><br><span class="line">urlpatterns=[</span><br><span class="line">    path(<span class="string">'login/'</span>,views.login),<span class="comment">#登录页</span></span><br><span class="line">    path(<span class="string">'login_check'</span>,views.login_check),<span class="comment">#登录检测</span></span><br><span class="line">    ]</span><br></pre></td></tr></table></figure>
<h3 id="3）templates-app1-login-html"><a href="#3）templates-app1-login-html" class="headerlink" title="3）templates/app1/login.html"></a>3）templates/app1/login.html</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"zh"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;!-- 【0】引入jquery --&gt;</span><br><span class="line">    &lt;script src="/static/js/jquery-1.12.4.min.js"&gt;&lt;/script&gt;</span><br><span class="line">    &lt;title&gt;登录页面&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 写ajax处理函数</span><br><span class="line">    $(function () &#123;</span><br><span class="line">        $(<span class="string">'#btnLogin'</span>).click(function () &#123;</span><br><span class="line">            //<span class="number">1.</span>获取用户名、密码、是否记住用户名</span><br><span class="line">            username=$(<span class="string">'#username'</span>).val()</span><br><span class="line">            password=$(<span class="string">'#password'</span>).val()</span><br><span class="line">            remember=$(<span class="string">'#remember'</span>).val() //【<span class="number">2</span>】是否记住用户名</span><br><span class="line">            //<span class="number">2.</span>发起ajax--post(username,password)请求验证，地址：/login_check</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                <span class="string">'url'</span>:<span class="string">'/login_check'</span>,//验证地址</span><br><span class="line">                <span class="string">'type'</span>:<span class="string">'post'</span>,//请求类型</span><br><span class="line">                <span class="string">'data'</span>:&#123;<span class="string">'username'</span>:username,<span class="string">'password'</span>:password,<span class="string">'remember'</span>:remember&#125;,//【<span class="number">3</span>】发送数据，加上remember</span><br><span class="line">                <span class="string">'dataType'</span>:<span class="string">'json'</span>,//希望返回数据类型</span><br><span class="line">            &#125;).success(function(data)&#123;</span><br><span class="line">                //成功返回&#123;<span class="string">'res'</span>:<span class="number">1</span>&#125;,失败&#123;<span class="string">'res'</span>:<span class="number">0</span>&#125;</span><br><span class="line">                <span class="keyword">if</span>(data.res===<span class="number">0</span>)&#123;</span><br><span class="line">                    $(<span class="string">'#msg'</span>).show().html(<span class="string">'用户名或密码错误请重试！'</span>)//登录失败则显示msg，并在里写入信息</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;//成功跳转到books页面</span><br><span class="line">                    location.href=<span class="string">'/books'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">    /* 信息提示样式 */</span><br><span class="line"><span class="comment">#msg&#123;</span></span><br><span class="line">    display: none;</span><br><span class="line">    color:red;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;!-- 原form删除，input的name变id，方便jquery操作 --&gt;</span><br><span class="line">    &lt;!-- 【4】把views页的login()函数传过来的用户名，密码赋值给对应处 --&gt;</span><br><span class="line">    用户名:&lt;input type=<span class="string">"text"</span> id=<span class="string">"username"</span> value=<span class="string">"&#123;&#123;username&#125;&#125;"</span>&gt;&lt;br/&gt;</span><br><span class="line">    密码:&lt;input type=<span class="string">"password"</span> id=<span class="string">"password"</span> value=<span class="string">"&#123;&#123;password&#125;&#125;"</span>&gt;&lt;br/&gt;</span><br><span class="line">    &lt;!-- 加入一个信息提示框，用于密码等错误提示 --&gt;</span><br><span class="line">    &lt;div id="msg"&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- 【1】记住用户名，设置cookie用，如果勾选则其value=on --&gt;</span><br><span class="line">    &lt;input type=<span class="string">"checkbox"</span> id=<span class="string">"remember"</span>&gt;记住用户名&lt;br/&gt;</span><br><span class="line">    &lt;!-- 按钮type改button,加一个id方便jquery操作 --&gt;</span><br><span class="line">    &lt;input type=<span class="string">"button"</span> id=<span class="string">"btnLogin"</span> value=<span class="string">"登录"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="效果：http-127-0-0-1-8000-login"><a href="#效果：http-127-0-0-1-8000-login" class="headerlink" title="效果：http://127.0.0.1:8000/login"></a>效果：<a href="http://127.0.0.1:8000/login" target="_blank" rel="noopener">http://127.0.0.1:8000/login</a></h3><ol>
<li>第一次登录勾选记住用户名密码后</li>
<li>再访问登录页时，将自动跳转到：<a href="http://127.0.0.1:8000/books" target="_blank" rel="noopener">http://127.0.0.1:8000/books</a></li>
</ol>
<h2 id="3-4-cookie和session的应用场景"><a href="#3-4-cookie和session的应用场景" class="headerlink" title="3.4 cookie和session的应用场景"></a>3.4 cookie和session的应用场景</h2><ul>
<li>cookie:记住用户名。安全性要求不高。</li>
<li>session:涉及到安全性要求比较高的数据。银行卡账户,密码</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/blog/2020/01/10/python%E7%8E%AF%E5%A2%83%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E6%8A%80%E5%B7%A7/" rel="prev" title="python环境依赖管理技巧">
      <i class="fa fa-chevron-left"></i> python环境依赖管理技巧
    </a></div>
      <div class="post-nav-item">
    <a href="/blog/2020/01/11/Python%20@%E5%87%BD%E6%95%B0%E8%A3%85%E9%A5%B0%E5%99%A8%E5%8F%8A%E7%94%A8%E6%B3%95/" rel="next" title="Python @函数装饰器及用法">
      Python @函数装饰器及用法 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一-状态保持的概述"><span class="nav-number">1.</span> <span class="nav-text">一.状态保持的概述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、Cookie（存储在客户端）"><span class="nav-number">2.</span> <span class="nav-text">二、Cookie（存储在客户端）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-cookie的特点："><span class="nav-number">2.1.</span> <span class="nav-text">1.1 cookie的特点：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-cookie基础使用案例"><span class="nav-number">2.2.</span> <span class="nav-text">1.2 cookie基础使用案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1）app1-views-py编写设置cookie设置-获取函数"><span class="nav-number">2.2.1.</span> <span class="nav-text">1）app1&#x2F;views.py编写设置cookie设置&#x2F;获取函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2）配置app1-urls-py"><span class="nav-number">2.2.2.</span> <span class="nav-text">2）配置app1&#x2F;urls.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果："><span class="nav-number">2.2.3.</span> <span class="nav-text">效果：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#http-127-0-0-1-8000-setCookie"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;setCookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-127-0-0-1-8000-getCookie"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;getCookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关闭浏览器之后，再请求cookie即找不到之前设置的cookie-因为没指定时间，所以用默认设置，关闭即过期："><span class="nav-number">2.2.3.3.</span> <span class="nav-text">关闭浏览器之后，再请求cookie即找不到之前设置的cookie,因为没指定时间，所以用默认设置，关闭即过期：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3）设置cookie过期时间views-py"><span class="nav-number">2.2.4.</span> <span class="nav-text">3）设置cookie过期时间views.py</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#效果：http-127-0-0-1-8000-setCookie"><span class="nav-number">2.2.4.1.</span> <span class="nav-text">效果：http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;setCookie</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-设置多个cookie"><span class="nav-number">2.2.5.</span> <span class="nav-text">4) 设置多个cookie</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-记住用户名案例"><span class="nav-number">2.3.</span> <span class="nav-text">1.3 记住用户名案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1）templates-app1-login-html"><span class="nav-number">2.3.1.</span> <span class="nav-text">1）templates&#x2F;app1&#x2F;login.html</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2）app1-urls-py-不重要"><span class="nav-number">2.3.2.</span> <span class="nav-text">2）app1&#x2F;urls.py(不重要)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3）app1-views-py【重点】"><span class="nav-number">2.3.3.</span> <span class="nav-text">3）app1&#x2F;views.py【重点】</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果-http-127-0-0-1-8000-login"><span class="nav-number">2.3.4.</span> <span class="nav-text">效果 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;login&#x2F;</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、Session（存储在服务器端）"><span class="nav-number">3.</span> <span class="nav-text">三、Session（存储在服务器端）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-配置"><span class="nav-number">3.1.</span> <span class="nav-text">1 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#启用Session"><span class="nav-number">3.1.1.</span> <span class="nav-text">启用Session</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#存储方式"><span class="nav-number">3.1.2.</span> <span class="nav-text">存储方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-使用方法："><span class="nav-number">3.2.</span> <span class="nav-text">2 使用方法：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-设置：session-request-session-39-username-39-39-jim-39"><span class="nav-number">3.2.1.</span> <span class="nav-text">1.设置：session:request.session[&#39;username&#39;]&#x3D;&#39;jim&#39;</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-获取：session-request-session-39-username-39"><span class="nav-number">3.2.2.</span> <span class="nav-text">2.获取：session:request.session[&#39;username&#39;]</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-清除所有session，在存储中删除值部分。"><span class="nav-number">3.2.3.</span> <span class="nav-text">3.清除所有session，在存储中删除值部分。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-清除session数据，在存储中删除session的整条数据。"><span class="nav-number">3.2.4.</span> <span class="nav-text">4. 清除session数据，在存储中删除session的整条数据。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-删除session中的指定键及值，在存储中只删除某个键及对应的值。"><span class="nav-number">3.2.5.</span> <span class="nav-text">5. 删除session中的指定键及值，在存储中只删除某个键及对应的值。</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-设置会话的超时时间，如果没有指定过期时间则两个星期后过期。"><span class="nav-number">3.2.6.</span> <span class="nav-text">6.设置会话的超时时间，如果没有指定过期时间则两个星期后过期。</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-session的特点："><span class="nav-number">3.3.</span> <span class="nav-text">3.1 session的特点：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-session基本设置、获取、清除案例"><span class="nav-number">3.4.</span> <span class="nav-text">3.2 session基本设置、获取、清除案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1）app1-views-py"><span class="nav-number">3.4.1.</span> <span class="nav-text">1）app1&#x2F;views.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2）app1-urls-py"><span class="nav-number">3.4.2.</span> <span class="nav-text">2）app1&#x2F;urls.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果-http-127-0-0-1-8000-setSession"><span class="nav-number">3.4.3.</span> <span class="nav-text">效果 http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;setSession</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#http-127-0-0-1-8000-getSession"><span class="nav-number">3.4.4.</span> <span class="nav-text">http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;getSession</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#http-127-0-0-1-8000-clearSession"><span class="nav-number">3.4.5.</span> <span class="nav-text">http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;clearSession</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#扩展：session的数据库保存值是base64编码"><span class="nav-number">3.4.6.</span> <span class="nav-text">扩展：session的数据库保存值是base64编码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-记住用户登录状态案例"><span class="nav-number">3.5.</span> <span class="nav-text">3.3 记住用户登录状态案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1）app1-views-py编写登录函数-设置session-读取session"><span class="nav-number">3.5.1.</span> <span class="nav-text">1）app1&#x2F;views.py编写登录函数:设置session,读取session</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2）app1-urls-py-1"><span class="nav-number">3.5.2.</span> <span class="nav-text">2）app1&#x2F;urls.py</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3）templates-app1-login-html"><span class="nav-number">3.5.3.</span> <span class="nav-text">3）templates&#x2F;app1&#x2F;login.html</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#效果：http-127-0-0-1-8000-login"><span class="nav-number">3.5.4.</span> <span class="nav-text">效果：http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;login</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-cookie和session的应用场景"><span class="nav-number">3.6.</span> <span class="nav-text">3.4 cookie和session的应用场景</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="晨曦"
      src="http://www.zeyajt.com/u/40b74ddb-a87b-41cd-821b-3f6eeb544661/image/637203952121373129.jpg">
  <p class="site-author-name" itemprop="name">晨曦</p>
  <div class="site-description" itemprop="description">晨曦的技术博客，专注于python、vue、react、人工智能、爬虫、大数据分析</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">95</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/blog/categories/">
          
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/blog/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">晨曦</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/pisces.js"></script>


<script src="/blog/js/next-boot.js"></script>




  















  

  


 
</body>
</html>
